
$(function() {
    let form = $('.js-form'),
        formBtn = $('.js-form-btn'),
        modalView = $('.js-modal-view'),
        modalHidden = $('.js-modal-hidden'),
        hiddenModal = $('.js-hidden'),
        loader = $('.js-loader'),
        formTelephone = $('.js-form-tel');


    formTelephone.mask("+7(999) 999-99-99");

    formTelephone.on('focus', function(){
        formTelephone.parent().addClass('_focus');
    });
    formTelephone.on('blur', function(){
        if($(this).val() == "") {
            formTelephone.parent().removeClass('_focus');
        }
    });
    formTelephone.on('keyup', function(){
        if($(this).val() != "") {
            formTelephone.parent().addClass('_focus');
        } 
    });
    formBtn.on('click', function(){
        if(formTelephone.val() == "") {
            formTelephone.addClass('_error');
            formTelephone.parent().addClass('_error');
            setTimeout(function() {backState()}, 2000);
        } else {
            loader.fadeIn(500);
        }
    });

    function backState() {
        formTelephone.removeClass('_error');
        formTelephone.parent().removeClass('_error');
    }
    

    form.on('submit', function(e) {
        e.preventDefault();
        let form_data = $(this).serialize();
        

        if(formTelephone.val() != "") {
            setTimeout(function() {
                $.ajax({
                    type: "POST",
                    url: "https://jsonplaceholder.typicode.com/posts",
                    data: form_data,
                    success: function() {
                        truePOST();
                    }
                });
            }, 1000)
        }
        
    });

    function truePOST() {

        modalView.fadeOut(500);
        modalHidden.fadeIn(500);

        setTimeout(function() {
            hiddenModal.fadeOut(500);
            modalView.fadeIn(500);
            modalHidden.fadeOut(500);
            loader.fadeOut(500);

            formTelephone.val("");
            formTelephone.parent().removeClass('_focus');
        }, 3000)
    }

    
});
$(function() {
    let hiddenModal = $('.js-hidden'),
        madalCallBtn = $('.js-offer__button'),
        modalCloce = $('.js-modal-close'),
        modal = $('.js-modal');

    madalCallBtn.on('click', function() {
        hiddenModal.fadeIn(500);
    });

    modalCloce.on('click', function(e) {
        if($(e.target).parent()) hiddenModal.fadeOut(500);
    });

    $(window).on('click', function(e) {
        if(!$(e.target).closest(modal).length && !$(e.target).closest(madalCallBtn).length) {
            hiddenModal.fadeOut(500);
        }
    });
})
$(function() {
    let owlCarousel = $('.owl-carousel');
        
    owlCarousel.owlCarousel({
        autoWidth:true,
        loadedClass: false,
        lazyLoad: true,
    });
});
$(function() {
    let switchBtn = $('.js-payment-option__switch'),
    servicesText = $('.js-payment-option__text');

    switchBtn.on('change', function() {
        switchBtn.prop('checked', $(this).checked);
        if(switchBtn.is(':checked')) {
            servicesText.eq(1).addClass('payment-option__text_active');
            servicesText.eq(0).removeClass('payment-option__text_active');
        } else {
            servicesText.eq(0).addClass('payment-option__text_active');
            servicesText.eq(1).removeClass('payment-option__text_active');
        }
    });
}); 
$(function() {
    
    let navBtn = $('.js-nav__button'),
        carTabs = $('.js-tab__item'),
        tabs = $('.js-tab'),
        bigCar = $('.js-big-car'),
        priceModel = $('.js-price-model'),
        priceNumb = $('.js-product-price__numb');

    const cars = [
        {model: "XC90", price: "200 000"},
        {model: "XC60", price: "250 000"},
        {model: "XC40", price: "300 000"},
        {model: "S60", price: "260 000"},
        {model: "S90", price: "280 000"},
        {model: "V90", price: "230 000"},
        {model: "V60", price: "240 000"}
    ]
        
    $.each(navBtn, function(i){
        navBtn.eq(i).on('click', function(){
            $.each(navBtn,function(){
                $(this).removeClass('nav__button_active');
            });
            $(this).addClass('nav__button_active')
            productsTabFunc(i, tabs);
        });
    });

    function productsTabFunc(i, tabs) {
        $.each(tabs, function(){
            $(this).removeClass('tab_active');
        });
        tabs.eq(i).addClass('tab_active');
    }
    $.each(carTabs, function(i){
        carTabs.eq(i).on('click', function(){
            $.each(carTabs,function(){
                $(this).removeClass('tab__item_active');
            });
            $(this).addClass('tab__item_active');
            let carModelName =  $(this).data('name');
            priceModel.text(carModelName);
            
            bigModelsSwitch(carModelName, i)

        });
    });

    function bigModelsSwitch(carmodelName) {
        const imageLink = `./_assets/img/content/${carmodelName}.png`
        bigCar.attr('src', imageLink);

        $.each(cars, function(index, value) {
            if(value.model == carmodelName) {
                priceNumb.text(value.price);
            }
        })
    }
})